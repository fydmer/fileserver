# fileserver

### Что это?

**fileserver** служит хранения загружаемых файлов по частям, распределенными между подключенными нодами. 
Не имеет внешних зависимостей, кроме драйвера для Postgres.

Сервис `controller` предоставляет методы для добавления нод и менеджемнта файлов (+ генератор случайных для тестов).

Сервис `node` экземпляры ноды, где хранятся части файлов.


### Как работает?

- `controller` хранит информацию о нодах и файлах в **postgres** 
(схема [тут](internal/schema/database/migrations/0001.sql))
- `controller` подключается к `nodeX` по **tcp** с импровизированным контрактом (не grpc и не http) и так гоняет файлы
- для сохранения новых файлов выбираются наименее заполенные ноды


### Что можно улучшить?

- Оптимизировать протокол взаимодейтвия между `controller` и `nodeX`
- Добавить health-чеки и ping для `node`
- Задавать нодам лимит на использование пространства диска
- Чекать реальное дисковое пространство или занимать место большим фикс файлом и наделать его виртуальное деление
- Убрать базу, собирать инфу о файлах с нод (закинуть на ноды локальные базенки) + ноду подключать к контроллеру
